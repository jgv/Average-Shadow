(function(a){a.avgShadow=function(b,c){var d=this;d.$el=a(b),d.el=b,d.init=function(){d.options=a.extend({},a.avgShadow.options,c),d.cleanOptions()},d.cleanOptions=function(){d.options.inset&&(d.options.inset="inset");for(var b in d.options){var c=d.options[b];if(typeof c=="string"){var e=c.replace(/px/i,"");a.trim(e),d.options[b]=e}}d.start()},d.start=function(){if(!d.supportsCanvas())return;d.el.onload=function(){var a={r:0,g:0,b:0},b=5,c=document.createElement("canvas");c.width=d.el.width,c.height=d.el.height;var e=c.getContext&&c.getContext("2d");e.drawImage(d.el,0,0,d.el.width,d.el.height);var f=e.getImageData(0,0,d.el.width,d.el.height),g=f.data.length,h=-4,i=0;while((h+=b*4)<g)++i,a.r+=f.data[h],a.g+=f.data[h+1],a.b+=f.data[h+2];a.r=~~(a.r/i),a.g=~~(a.g/i),a.b=~~(a.b/i),d.el.style.boxShadow=d.options.horizontal+"px "+d.options.vertical+"px "+d.options.blur+"px "+d.options.spread+"px "+"rgb("+a.r+", "+a.g+", "+a.b+")"+d.options.inset}},d.supportsCanvas=function(){var a=document.createElement("canvas");return a.getContext?!0:!1},d.init()},a.avgShadow.options={horizontal:0,vertical:0,blur:"10px",spread:5,inset:""},a.fn.avgShadow=function(b){return this.each(function(){new a.avgShadow(this,b)})}})(jQuery);