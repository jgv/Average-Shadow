/*
 * Average Shadow v1.1
 * Jonathan Vingiano
 *
 */

(function(b){b.avgShadow=function(e,h){var a=this;a.$el=b(e);a.el=e;a.init=function(){a.options=b.extend({},b.avgShadow.options,h);a.cleanOptions();if(null==b.prop){if("img"!==a.$el.attr("tagName").toLowerCase())throw"Average Shadow: This plugin will only work with an <img> element.";}else if("img"!==a.$el.prop("tagNmae").toLowerCase())throw"Average Shadow: This plugin will only work with an <img> element.";!a.supportsCanvas()&&a.options.fallbackColor&&a.fallback();if(!a.supportsCanvas())throw"Average Shadow: This browser doesn't support the canvas element.";
a.el.complete||4===a.el.readystate?a.start():a.el.onload=function(){a.start()}};a.cleanOptions=function(){a.options.inset&&(a.options.inset="inset");for(var i in a.options){var d=a.options[i];"string"===typeof d&&(d=d.replace(/px/i,""),b.trim(d),a.options[i]=d)}};a.start=function(){var b=0,d=0,e=0,c=document.createElement("canvas");c.width=a.el.width;c.height=a.el.height;c=c.getContext&&c.getContext("2d");c.drawImage(a.el,0,0,a.el.width,a.el.height);for(var c=c.getImageData(0,0,a.el.width,a.el.height),
h=c.data.length,f=-4,g=0;(f+=20)<h;)++g,b+=c.data[f],d+=c.data[f+1],e+=c.data[f+2];a.el.style.boxShadow=a.options.horizontal+"px "+a.options.vertical+"px "+a.options.blur+"px "+a.options.spread+"px rgb("+~~(b/g)+", "+~~(d/g)+", "+~~(e/g)+")"+a.options.inset};a.fallback=function(){a.el.style.boxShadow=a.options.horizontal+"px "+a.options.vertical+"px "+a.options.blur+"px "+a.options.spread+"px "+a.options.fallbackColor+" "+a.options.inset};a.supportsCanvas=function(){return document.createElement("canvas").getContext?
!0:!1};a.init()};b.avgShadow.options={horizontal:0,vertical:0,blur:"10px",spread:5,inset:"",fallbackColor:null};b.fn.avgShadow=function(e){return this.each(function(){new b.avgShadow(this,e)})}})(jQuery);
